# 🌏💬 실시간 채팅 번역 서비스

🚨개인프로젝트로 만든 서비스이며, 실제 실시간 채팅과 알림을 테스트 해보지 않아 정확하지 않습니다.
다국어 사용자들이 실시간으로 대화를 번역하여 소통할 수 있는 서비스를 제공하고자 합니다.

---
## ⚙️ Tech Stack

- Java 11
- Spring Boot MVC
- Gradle
- JWT
- Mysql
- Redis
- QueryDSL
- WebSocket
- Stomp
- Kafka
- 번역 api : papago api
---

## 📋 프로젝트 기능 및 설계
### 🙋 회원
- [회원가입 기능]
    - 모든 사용자는 회원가입시 USER 권한 (일반 권한)을 지닙니다.
    - 회원가입시 아이디와 패스워드, 서비스에서 사용할 이름, 국적, 언어를 입력받습니다.
    - 아이디와 서비스에서 사용할 이름은 unique 해야합니다.(동기화 이슈를 막기 위해 RedisLock 사용)
- [로그인 기능]
    - 로그인시 회원가입때 사용한 아이디와 패스워드가 일치해야 합니다.
    - 로그인 성공 시 사용자에게 JsonWebToken 을 발급합니다.
- [회원 정보 조회]
    - 사용자는 회원 정보(국적, 사용 언어, 이름)을 조회할 수 있습니다.
    - 신고하기(랜덤 채팅에서만 가능하며, 친구는 신고할 수 없습니다.)
- [내 정보 수정]
    - 사용자는 자신의 회원 정보(국적, 사용 언어, 이름)를 수정할 수 있습니다.
- [탈퇴하기]
    - 사용자는 계정을 삭제하여 탈퇴할 수 있습니다.
- [유저 검색 기능]
    - 사용자는 '이름'으로 검색해 상대방의 회원 정보를 조회 할 수 있습니다.
---
### 👯 즐겨찾기 / 차단
- [관심 유저 추가]
  - 사용자는 관심있는 유저를 즐겨찾기 목록에 추가할 수 있습니다.
- [관심 유저 삭제]
    - 관심 유저를 즐겨찾기 목록에서 삭제합니다.
- [관심 유저 목록 조회]
  - 즐겨찾기 유저 목록을 조회할 수 있습니다.
- [유저 차단]
  - 특정 유저를 차단할 수 있습니다.
- [차단된 유저 목록 조회/ 차단 해제 기능]
    - 차단된 유저 목록을 조회할 수 있고, '차단 해제'를 할 수 있습니다.
---
### 💬 일반 채팅
- [유저 대화 기능]
  - 실시간으로 메세지가 번역되어 다른 유저와 1:1대화를 할 수 있습니다.
  - 사용자가 대화방을 생성하여 다른 유저를 대화방으로 초대합니다.(대화 요청)
    - 요청받은 유저는 대화 초대를 '수락/거절' 할 수 있습니다.  
    - 나의 메세지를 상대방의 언어로 번역하여 메세지를 전송합니다.
    - 자신을 차단한 유저에게 대화를 요청할 경우 '상대를 찾을 수 없습니다'라고 안내합니다.
- [대화방 목록 조회 기능]
    - 대화 하고 있는 대화방 목록을 조회할 수 있습니다.
---
### 🎲 랜덤 채팅
- [랜덤 매칭 대화 기능]
  - 랜덤 채팅방은 1:1로만 매칭 됩니다.
  - 나의 메세지를 서버에서 상대방의 언어로 번역하여 메세지를 전송합니다.
  - 매칭 방식 : 랜덤 채팅을 시작하는 유저의 대기열을 redis 큐를 이용하여 서로 매칭 되도록 합니다.
  - 대화방에서 1명이라도 나가면 남은 1명에게 "상대방이 채팅방을 나갔습니다"라는 안내 후 방이 삭제됩니다.

    - [랜덤 채팅 신고 기능]
        - 사용자는 상대방을 신고할 수 있습니다.
          - 신고 대상이 이미 '이용 정지 상태'이거나 한달 안에 신고한 적이 있다면 신고 불가합니다.
        - 신고 받은 회원은 경고를 받습니다.
        - 경고 누적 3회를 받은 회원은 '랜덤 채팅 기능'을 일주일 이용 정지됩니다.
          - 아용 정지 해제 후 경고 횟수는 0으로 초기화 됩니다.
---
### 🛎️ 알람
WebSocket 이용해 비동기 처리합니다.
- 알람 기능에는 아래의 내용들을 조회할 수 있습니다.
  - 대화 요청, 결과
  - 랜덤 서비스 이용 정지 안내("회원님은 (이용정지 날짜)까지 랜덤 서비스를 이용하실 수 없습니다.")
- 알람을 읽은 경우 알람을 삭제합니다.
  - 읽지 않은 알람의 목록을 조회할 수 있습니다.
---
## 🔍 ERD
![](docs/erd.png)

---
## 🐥 papago api
- 1일 10000자 무료.
  - Redis를 활용해 최적화할 수 있음. 
- 만약 원본언어 -> 목적언어로 안되는 경우
    - 원본언어를 한국어로 번역 후 목적언어로 번역

<details>
<summary>papago 지원 언어</summary>
| 원본 언어(언어 코드)	   | 	목적 언어(언어 코드)	  |	원본 언어(언어 코드)		|목적 언어(언어 코드)|
|-----------------|-----------------|---|---|
| 한국어(ko)	→       | 	영어(en)	        |	영어(en)	→|	한국어(ko)|
| 한국어(ko)	→       | 	일본어(ja)	       | 	일본어(ja)	→|	한국어(ko)|             
| 한국어(ko)	→       | 	중국어 간체(zh-CN)	 | 	중국어 간체(zh-CN)	→|	한국어(ko)  |     
| 한국어(ko)	→       | 	중국어 번체(zh-TW)	 | 	중국어 번체(zh-TW)	→|	한국어(ko)  |     
| 한국어(ko)	→       | 	베트남어(vi)	      | 	베트남어(vi)	→|	한국어(ko)    |        
| 한국어(ko)	→       | 	인도네시아어(id)	    | 	인도네시아어(id)	→|	한국어(ko)   |       
| 한국어(ko)	→       | 	태국어(th)	       | 	태국어(th)	→|	한국어(ko)     |        
| 한국어(ko)	→       | 	독일어(de)	       | 	독일어(de)	→|	한국어(ko)     |        
| 한국어(ko)	→       | 	러시아어(ru)	      | 	러시아어(ru)	→|	한국어(ko)     |       
| 한국어(ko)	→       | 	스페인어(es)	      | 	스페인어(es)	→|	한국어(ko)     |       
| 한국어(ko)	→       | 	이탈리아어(it)	     | 	이탈리아어(it)	→|	한국어(ko)        |   
| 한국어(ko)	→       | 	프랑스어(fr)	      | 	프랑스어(fr)	→|	한국어(ko)      |      
| 영어(en)	→        | 	일본어(ja)	       | 	일본어(ja)	→|	영어(en)       |       
| 영어(en)	→        | 	프랑스어(fr)	      | 	프랑스어(fr)	→|	영어(en)       |      
| 영어(en)	→        | 	중국어 간체(zh-CN)	 | 	중국어 간체(zh-CN)	→|	영어(en)      |  
| 영어(en)	→        | 	중국어 번체(zh-TW)	 | 	중국어 번체(zh-TW)	→|	영어(en)     |   
| 일본어(ja)	→       | 	중국어 간체(zh-CN)	 | 	중국어 간체(zh-CN)	→|	일본어(ja)      | 
| 일본어(ja)	→       | 	중국어 번체(zh-TW)	 | 	중국어 번체(zh-TW)	→|	일본어(ja)       |
| 중국어 간체(zh-CN)	→ | 	중국어 번체(zh-TW)	 | 	중국어 번체(zh-TW)	→|	중국어 간체(zh-CN) |

</details>

---
## 🥹 개선해야하는 점, 느낀점
- papago api 의 1일 10000자 제한을 최적화 하기위해 캐싱을 고려해야하는데 데이터를 어떤식으로 저장할지에 대한 고민이 남아 구현하지 못했습니다.
- socket.js를 작성하지 못해 웹소켓을 이용하는 부분의 api 테스트를 진행하지 못하였습니다. 
- 채팅 시스템이 재밌어보여 도전하였으나 웹소켓에 대해 더 공부해야겠다고 느꼈습니다..

## 📋 api 명세서
[포스트맨](https://documenter.getpostman.com/view/27442432/2s9Xy5LAQ2)

## 💥 Trouble Shooting
[go to the trouble shooting section](docs/TROUBLE_SHOOTING.md)
